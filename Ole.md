# OLE Object Linked and Embedded
Ole is a class, subclass of [MInimal JSON](https://github.com/ralfstx/minimal-json) which provides some META fields to arrange a plain JSON Object and provide additional value-added services to encode structured data such as files, either binary or ascii, config files, list of items (sets), queries to relational databases, data tables (including those results generated by database queries). All of these types of structures objects are automatically serialized as JSON strings, ready to be manipulated and sent over the internet, and they can also be encrypted/decrypted by a 128bits-RSA encryptation provided by the class [Cryptor](https://github.com/Anatoli-Grishenko/LARVA-Ecosystem/blob/main/Cryptor.md)

## Basic Ole
It is a JsonObject with a META field that contains semantic data about its content.
- OLE-ID: An alphanumeric hash code of the object 
- TYPE: An enum type wich describe the type/subtype of Ole objects. Every subtype is also a JsonObject with specific inputs and values
 ![image](https://user-images.githubusercontent.com/9058636/154640288-e59462e1-e0b9-429b-87a1-02aafbd39896.png)
- DATE: date of creation
- DESCRIPTION: a short explanation of the object
- FIELDS: List of net objects, wich could be a String, an Integer, a Double, a Boolean a nested Ole, or an array of all the previous types


## OleFile
It provides the framework for translating any file, either binary or ascii, into a serializable, and therefore, easy to transmit, Ole Object. It can be combined with encription capabilities to safely transmit/store encrypted files

````
 	OleFile ()
 	Basic constructor. It defines the specific fields of this object.
 
 	OleFile (Ole o)
 	Copy constructor. More...
 
OleFile 	loadFile (String fullfilename)
 	It takes the binary (byte[]) content of any file, dump it as an integer Json Array. It encapsulates not only the binary content (key "filedata") but also the original filename (key "filename", just the filename, without the path to it. More...
 
boolean 	saveFile (String outputfolder)
 	Given an encapsulated binary file obtained with the method data.OleFile#loadFile(java.lang.String) it saves the image exactly with the concatenation of the name encapsulated in it, and the path specified in. More...
 
String 	getFileName ()
 	Retunrs the filename embedded into a OleFile object. More...
````

## OleTable
It provides support for labeled tables, in which all the rows have the same structure and there is a row of labels, one for each column, that can be used to access all elements of the table
| |Label0|Label1|

## OleCOnfig & OleDialog

It provides support for managing regular options of a project, storing/loading on disk, editing on Swing, etc, by using either pure JSON format or the extended OleCOnfig format. In either case, once loaded from disk, through the inherited method Ole.loadFile()

### Types of fields
An extension of JSON types. with extra capabilities
- Integer
- Double
- String
   - Regular strings
   - File names
   - Folder names
   - From a list of valid values 
- Boolean
- Sets of strings



### Simple examples
In all of them, the config file is loaded and edited within a Java Dialog
````
    String filename = "config_simplest.json";
    OleConfig ocfg;
    ocfg = new OleConfig();
    ocfg.loadFile(filename);
    OleDialog odiag = new OleDialog(null, filename);
    if (odiag.run(ocfg)) {
        System.out.println("Aceptado. Guardando datos");
        ocfg = odiag.getResult();
        ocfg.saveAsFile("./", filename, true);
     } else {
        System.out.println("Cancelado. No se guardar√°n los datos");
     }
````


#### Simplest case


````
file: config.simplest.json
{
    "Hostname": "localhost",
    "Port": 1099,
    "SSH": true
}
````

![image](https://user-images.githubusercontent.com/9058636/155308735-ac67277a-1f92-4799-a920-013c5fb7dc33.png)

#### Using different sections
A config file might contain diferent subsections of options. Each of them is displayed as a tab

````
file: config.tabs.json
{
    "Conection": {
        "Hostname": "localhost",
        "Port": 1099,
        "SSH": true
    },
    "Documents": {
        "Executive summary": "exec.pdf"
    }
}
}
````

![Captura de pantalla 2022-02-24 07:06:52](https://user-images.githubusercontent.com/9058636/155467637-4cae81e0-6e3c-44c2-b516-92fd9bf632be.png) 
![Captura de pantalla 2022-02-24 07:07:04](https://user-images.githubusercontent.com/9058636/155467650-f09f9ada-7447-4b0c-b40d-c8f16a526a92.png)



### Personalization and tooltips
Each field/option/tab can have a customized help message that appears when the mouse is over it.


````
{
  "options": {
    "Conection": {
      "Hostname": "localhost",
      "Port": 1099,
      "SSH": true
    },
    "Documents": {
      "Executive summary": "exec.pdf"
    }
  },
  "properties": {
    "Conection": {
      "tooltip": "Connect to the main server"
    },
    "Hostname": {
      "tooltip": "String. Name of the server"
    },
    "Port": {
      "tooltip": "Integer. Communcation port"
    },
    "SSH": {
      "tooltip": "Boolean. Activate SSH tunnel"
    },
    "Documents": {
      "tooltip": "String. Files to upload"
    }
  }
}
```` 
![image](https://user-images.githubusercontent.com/9058636/155468945-8c72c91b-24b0-4ee4-80f6-7a2e451f98f7.png) ![image](https://user-images.githubusercontent.com/9058636/155469047-389d98c5-34d2-4a18-8572-ce84a531ca49.png)



### Grouping options or fields
To group several fields from the inside of a tab.
````
{
    "options": {
        "Conection": {
            "Host": {
                "Hostname": "localhost",
                "Port": 1099
            },
            "SSH": true
        },
        "Documents": {
            "Executive summary": "exec.pdf"
        }
    },
    "properties": {
        "Conection": {
            "tooltip": "Connect to the main server"
        },
        "Hostname": {
            "tooltip": "String. Name of the server"
        },
        "Port": {
            "tooltip": "Integer. Name of the server"
        },
        "SSH": {
            "tooltip": "Boolean. Activate SSH tunnel"
        },
        "Documents": {
            "tooltip": "String. Files to upload"
        },
        
        "Host":{
            "columns":2,
            "border":true
        }
    }
}
````
![image](https://user-images.githubusercontent.com/9058636/155315876-f9dc7920-de12-4ae8-a721-867bab17f11e.png)


### Support for flowlayout in groups and tabs
For defining a fluid grid of components all along the frame of the Dialog

![image](https://user-images.githubusercontent.com/9058636/155317166-2f7b26de-e38c-49da-99b1-665f7f78c704.png)

### Select value from within a predefined list (Combobox)
````
       "Hostname": {
            "tooltip": "String. Name of the server",
            "select":["localhost","my.server.org","my.cloud.com"]
        }
````
![image](https://user-images.githubusercontent.com/9058636/155470404-8e4d4e9e-4d95-4aa5-96a5-c1652ffcaf7f.png)


### Select a file or folder
````
{
  "options": {
    "Conection": {
      "Host": {
        "Hostname": "localhost",
        "Port": 1099
      },
      "SSH": true
    },
    "Documents": {
      "Executive summary": "output.pdf"
    }
  },
  "properties": {
    "Conection": {
      "tooltip": "Connect to the main server"
    },
    "Hostname": {
      "tooltip": "String. Name of the server",
      "select": [
        "localhost",
        "my.server.org",
        "my.cloud.com"
      ]
    },
    "Port": {
      "tooltip": "Integer. Name of the server"
    },
    "SSH": {
      "tooltip": "Boolean. Activate SSH tunnel"
    },
    "Documents": {
      "tooltip": "String. Files to upload"
    },
    "Executive summary": {
      "tooltip": "String. File to upload",
      "file": ""
    },
    "Host": {
      "columns": 2,
      "border": true
    }
  }
}
````
![image](https://user-images.githubusercontent.com/9058636/155471544-074e2784-cfba-4972-803b-357a5264e489.png)
